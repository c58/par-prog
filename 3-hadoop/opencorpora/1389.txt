Есть три физических тома по 6 с небольшим терабайт (16 винтов по 500Гб в RAID6). Склеиваем их MD страйпом в один бааальшой том размером почти в 20Тб. Охуеть, не клеится. Читаем доку, 32-х битный линукс не поддерживает больше 16Тб. Говно вопрос, распиливаем каждый том на 5,3Тб и 1.3Тб. Склеиваем большие тома в 16Тб, а маленькие - в 3.8Тб. Все работает, заебись, 800Мб/сек на чтение, ляпота. Делаем на обоих томах файловые системы (XFS) и заливаем туда кено. Вернее два кена, каждое кено по 1.4Тб размером. Где-то в начале копирования второго кена файловая система разваливается к ебеням прям на ходу. Чей-то там не может аллоцировать и вся хуйня. xfs_repair складывает 3/4 кена в lost+found с прикольными названиями директорий. Но содержимое директорий почти сохранено, и я вручную все раскладываю обратно, спасая 3/4 от 3/4. Ставлю докопироваться остальное (а одно кено, на минуточку, это 10-12 часов копирования). Через некоторое время все опять разваливается к ебеням. В общем после трех почти бессонных суток экспериментов выясняется что у MD внутри где-то ошибочка и оно записанное в определенное место первого тома кладет в еще менее определенное место второго. Ну и соответственно наоборот. Заменяем MD на LVM2, корчимся, но плюем что он показывает не 15.6Тб, а 1.28, что считает из 5.3Тб доступными только 4 и так далее, но главное - работает. Скорость правда упала с 800мб/сек до 730, но это тоже пережить можно. А я, бля, ему так верил. Уж MD-то, которому сто лет в обед, можно было отладить, блядь.
В процессе копирования кина я его просматривал местами, и неожиданно увидел что некоторые сцены сняты в моей собственной квартире :-) В смысле в родительской (отец - художник на этом фильме). Ощущения довольно своеобразные - смотришь кино, смотришь, и тут вдруг понимаешь...
